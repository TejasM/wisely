{% extends 'base-app-alt.html' %}
{% load staticfiles %}
{% block headers_css %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/style-news.css' %}"/>
    <link rel="stylesheet" type="text/css" href="{% static 'css/style-profile.css' %}"/>
{% endblock %}
{% load humanize %}
{% load inbox %}
{% block content %}
    <div class="row wide-row">
    {% if viewed_user == request.user %}
        <div class="large-4 columns" style="border-right: solid #D2D4D5 1px;  padding-top: 80px">
            <div class="row">
                <dl class="tabs vertical" style="width: 100%; height: 28em" data-tab>
                    <dd class="active"><a href="#panel1a"><i class="fa fa-bolt"></i>Recent Activities</a></dd>
                    <dd><a href="#panel2a"><i class="fa fa-envelope"></i>Inbox<span class="right">{% inbox_count %}</span></a></dd>

                    <dd><a href="#panel3a"><i class="fa fa-list"></i>Tasks</a>
                    </dd>
                    <dd><a href="#panel4a"><i class="fa fa-certificate"></i>Achievements</a></dd>
                    <dd><a href="#panel5a"><i class="fa fa-users"></i>Followers</a></dd>
                    <dd><a href="#panel6a"><i class="fa fa-user"></i>Following</a></dd>
                </dl>
            </div>
            <div class="row" style="margin-top: 30px;">
                <div class="large-3 columns">
                    <img src="{% static 'images/plus-icon.png' %}" style="width: 100%">
                </div>
                <div class="large-9 columns">
                    <div style="margin-top: 15px; margin-left: -10px">
                        <p style="color: #1E5376; font-size: 1.6em; font-weight: 700">Who To Follow</p>
                    </div>
                </div>
            </div>
            <div class="row" style="margin-top: 30px;">
                <ul class="follow-list">
                    {% for follow in who_to_follow %}
                        <li id="follow_{{ follow.id }}">
                            <div class="row" style="margin: 3% 5%;">
                                <div class="large-3 columns" style="padding: 0 4%;">
                                    <img {% if follow.picture %}src="/media/{{ follow.picture }}"
                                         {% else %}src="http://www.adas-lv.com/wp-content/uploads/2012/07/default_avatar.png"{% endif %}
                                         class="pull-left img-circle">
                                </div>
                                <div class="large-6 columns">
                                    <div>
                                        <h3 style="font-size: 16px">{{ follow.user.first_name }} {{ follow.user.last_name }}</h3>
                                        {% if follow.headline %}
                                            <p>{{ follow.headline }}</p>
                                        {% endif %}
                                    </div>
                                </div>
                                <div class="large-3 columns plus-i" style="text-align: center"
                                     onclick="follow_add({{ follow.id }});">
                                    +
                                </div>
                            </div>
                        </li>
                    {% endfor %}
                </ul>
            </div>
        </div>
        <div class="large-8 columns" style="padding-top: 80px">
    {% else %}
        <div class="large-12 columns" style="padding-top: 80px">
    {% endif %}
<div class="row profile-area"
     style="position:relative;
             height: 28em; background: url('{% static 'images/shutterstock_153034898.jpg' %}') no-repeat center center; background-size: cover">
    <div class="large-3 columns">
    </div>
    <div class="large-6 push-3 columns" style="text-align: center;">
        <img {% if user_profile.picture %}src="/media/{{ user_profile.picture }}"
             {% else %}src="http://www.adas-lv.com/wp-content/uploads/2012/07/default_avatar.png"{% endif %}
             class="img-circle" style="display: block; margin: 20px auto; height: 200px;">

        <div>
            <h3>{{ viewed_user.first_name }} {{ viewed_user.last_name }}</h3>

            <p>{% if user_profile.headline %}{{ user_profile.headline }}{% endif %}</p>
            <hr>
            <div class="info">
                <img src="{% static 'images/map-icon.png' %}">
                {% if user_profile.current_city %}{{ user_profile.current_city }}{% else %}
                    Toronto{% endif %}
                <br>
                <img src="{% static 'images/envelope-icon.png' %}"> {% if viewed_user.email %}
                {{ viewed_user.email }}{% else %}email@email.com{% endif %}
            </div>
        </div>
    </div>
    {% if viewed_user == request.user %}
        <div class="large-3 {% if public and viewed_user != user %}push-3{% endif %} columns">
            <div style="text-align: right; float: right">
                <i class="fa fa-gear icon-remove-sign"></i>
            </div>
        </div>
    {% endif %}
    {% if public and viewed_user != user %}
        <div style="position: absolute; bottom: 10px; right: 10px; z-index: 199">
            <img src="{% static 'images/message-icon.png' %}"
                 onclick="$('#compose-message').lightbox_me({centered: true});">
            <br>
            {% if viewed_user.userprofile not in user.userprofile.follows %}
                <img src="{% static 'images/follow-button.png' %}" style="margin-top: 10px" id='follow-button'>
            {% endif %}
        </div>
    {% endif %}
</div>
<div class="row">
    <div class="large-12 columns">
        <div class="tabs-content vertical" style="width: 100%">
            <div class="content active" id="panel1a">
                <div style="margin-top: 50px; margin-left: 90px;">
                    <span class="today-button">Today</span>
                </div>
                <ul id='timeline-profile'>
                    <li class='work-profile'>
                        <input class='radio' type='radio' checked>

                        <div class="relative">
                            <span class='date-profile'>12 May 2013</span>
                            <span class='circle-profile'></span>
                        </div>
                        <div class='content-profile'>
                            <p>
                                Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
                                tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
                                quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
                                consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
                                cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat
                                non proident, sunt in culpa qui officia deserunt mollit anim id est laborum.
                            </p>
                        </div>
                    </li>
                </ul>
            </div>
            {% if viewed_user == request.user %}
                <div class="content" id="panel2a" style="width: 100%">
                    {% include 'django_messages/inbox.html' %}
                </div>
                <div class="content" id="panel3a">
                    <p>Panel 3 content goes here.</p>
                </div>
                <div class="content" id="panel4a">
                    <p>Panel 4 content goes here.</p>
                </div>
                <div class="content" id="panel5a">
                    {% if followers %}
                        <ul class="follower-list">
                            {% for follower in followers %}
                                <li>
                                    <div class="row" style="margin: 3% 5%;">
                                        <div class="large-3 columns" style="padding: 0 4%;">
                                            <img {% if follower.picture %}src="/media/{{ follower.picture }}"
                                                 {% else %}src="http://www.adas-lv.com/wp-content/uploads/2012/07/default_avatar.png"{% endif %}
                                                 class="pull-left img-circle">
                                        </div>
                                        <div class="large-9 columns">
                                            <div>
                                                <h3 style="font-size: 16px">{{ follower.user.first_name }} {{ follower.user.last_name }}</h3>
                                                {% if follower.headline %}
                                                    <p>{{ follower.headline }}</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        No follower's yet!
                    {% endif %}
                </div>
                <div class="content" id="panel6a">
                    {% if user_profile.follows.count != 0 %}
                        <ul class="follower-list">
                            {% for following in user_profile.follows.all %}
                                <li>
                                    <div class="row" style="margin: 3% 5%;">
                                        <div class="large-3 columns" style="padding: 0 4%;">
                                            <img {% if following.picture %}src="/media/{{ following.picture }}"
                                                 {% else %}src="http://www.adas-lv.com/wp-content/uploads/2012/07/default_avatar.png"{% endif %}
                                                 class="pull-left img-circle">
                                        </div>
                                        <div class="large-9 columns">
                                            <div>
                                                <h3 style="font-size: 16px">{{ following.user.first_name }} {{ following.user.last_name }}</h3>
                                                {% if following.headline %}
                                                    <p>{{ following.headline }}</p>
                                                {% endif %}
                                            </div>
                                        </div>
                                    </div>
                                </li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        You are not following anyone yet!
                    {% endif %}
                </div>
            {% endif %}
        </div>
    </div>
</div>
</div>
</div>
    {% if public and viewed_user != request.user %}
        {% include 'django_messages/reply.html' with path=request.get_full_path %}
    {% endif %}
    <div id="other-messages" class="light-box">
        <i class="fa fa-times-circle-o close" style="margin-top: -25px; margin-right: -30px; float: right"></i>

        <div class="row text-center" id="other-message">
        </div>
    </div>
{% endblock %}
{% block additionalScripts %}
    <script src="{% static 'js/foundation/foundation.tab.js' %}"></script>
    <script src="{% static 'js/foundation/foundation.accordion.js' %}"></script>
    <script>
        $('#follow-button').click(function () {
            $.post('{% url 'users:follow' %}', {user_id: {{ viewed_user.id }} }).done(function (data) {
                if (data['HTTPRESPONSE'] == "1") {
                    $('#other-message').text('Now following {{ viewed_user.first_name }} {{ viewed_user.last_name }}');
                    $('#other-messages').show();
                    $('#follow-button').hide();
                } else {
                    $('#other-message').text('Something went wrong try again later');
                    $('#other-messages').show();
                }
            });
        });
        function follow_add(id) {
            $.post('{% url 'users:follow' %}', {user_id: id }).done(function (data) {
                if (data['HTTPRESPONSE'] == "1") {
                    $('#other-message').text('Now following {{ viewed_user.first_name }} {{ viewed_user.last_name }}');
                    $('#other-messages').lightbox_me({centered: true});
                    $('#follow_' + id.toString()).hide();
                } else {
                    $('#other-message').text('Something went wrong try again later');
                    $('#other-messages').lightbox_me({centered: true});
                }
            });
        }
    </script>
{% endblock %}
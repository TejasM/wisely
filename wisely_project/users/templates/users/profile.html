{% extends 'base-app.html' %}
{% load staticfiles %}
{% block additionalHeaders %}
    <link rel="stylesheet" type="text/css" href="{% static 'css/style-app.css' %}"/>
{% endblock %}
{% block nav-bar %}
    <li class=""><a href="{% url 'users:index' %}"><i class="fa fa-book"></i><span>Courses</span></a>
    </li>
    <li class=""><a href="{% url 'pledges:index' %}"><i
            class="fa fa-book"></i><span>Pledges</span></a>
    </li>
    <li class=""><a href="#"><i
            class="fa fa-book"></i><span>More Coming Soon!</span></a>
    </li>
{% endblock %}
{% block content %}
    <div class="col-md-8 col-md-offset-2">

    <div class="widget extra-top-margin">

        <!-- Widget heading -->
        <div class="widget-head">
            <h1 class="separator bottom">Your Profile</h1>
        </div>
        <div class="widget-body">
            <div class="bg-gray innerAll">
                <div class="media">
                    <img src="{% if user_profile.picture %}/media/


                        {{ user_profile.picture }}{% else %}http://www.adas-lv.com/wp-content/uploads/2012/07/default_avatar.png{% endif %}"
                         class="pull-left img-circle thumb hidden-sm" width="100">

                    <div class="media-body">
                        <h3 class="margin-none">{{ user.first_name }} {{ user.last_name }}</h3>

                        <div id="partial_profile_header"> {% include "users/partial-profile-header.html" %} </div>
                    </div>
                </div>
            </div>
            <div class="col-separator-h box"></div>

            <!-- Row -->
            <div class="row row-merge margin-none">
                <div class="col-lg-4">

                    <a href="" class="widget-stats widget-stats-1 widget-stats-inverse margin-none">
                                    <span class="glyphicons certificate"><i></i><span
                                            class="txt">Completed Pledges</span></span>

                        <div class="clearfix"></div>
                        <span class="count">{{ completed_pledges.count }}</span>
                    </a>

                </div>
                <div class="col-lg-4">

                    <a href="" class="widget-stats widget-stats-1 widget-stats-inverse margin-none">
                                    <span class="glyphicons certificate"><i></i><span
                                            class="txt">Current Pledges</span></span>

                        <div class="clearfix"></div>
                        <span class="count">{{ current_pledges.count }}</span>
                    </a>

                </div>
                <div class="col-lg-4">

                    <a href="" class="widget-stats widget-stats-primary widget-stats-1 margin-none">
                        <span class="glyphicons book"><i></i><span class="txt">Avg. Score (%)</span></span>

                        <div class="clearfix"></div>
                        <span class="count">100</span>
                    </a>

                </div>
            </div>

        </div>
        <!-- // END col-app -->

    </div>
    <div class="widget extra-top-margin">
        <div class="widget-body innerAll inner-2x">
            <div class="row">
                {% include "users/partial-profile-main.html" %}
            </div>

            <!-- // END col-app.col-unscrollable -->
        </div>
    </div>
    </div>

{% endblock %}
{% block additionalScripts %}
    <script>
        $(document).ready(function () {
            $('#editProfile').hide();
            $('#edit').live('click', function () {
                $('#edit').hide();
                $('#showProfile').hide();
                $('#editProfile').show();
            });

            $('#edit_headline_div').hide();
            $('#edit_headline').live('click', function () {
                $('#show_headline_div').fadeOut("fast");
                $('#edit_headline_div').fadeIn("slow");
            });

            $('#cancel_edit_headline').live('click', function () {
                $('#edit_headline_div').fadeOut("fast");
                $('#show_headline_div').fadeIn("slow");
            });

            $('#submit_edit_headline').live('click', function () {
                $('#edit_headline_div').fadeOut("fast");
                console.log("about to submit");
                $.post('{% url 'users:edit_profile' %}', $('#form_headline').serialize(), function (partial_render) {
                    $('#partial_profile_header').html(partial_render);
                    $('#edit_headline_div').hide();
                    $('#edit_about_me_div').hide();
                    console.log("reloaded");
                });
                return false;
            });

            $('#edit_about_me_div').hide();
            $('#edit_about_me').live('click', function () {
                $('#show_about_me_div').fadeOut("fast");
                $('#edit_about_me_div').fadeIn("slow");
            });

            $('#cancel_edit_about_me').live('click', function () {
                $('#edit_about_me_div').fadeOut("fast");
                $('#show_about_me_div').fadeIn("slow");
            });

            $('#submit_edit_about_me').live('click', function () {
                $('#edit_about_me_div').fadeOut("fast");
                console.log("about to submit");
                $.post('{% url 'users:edit_profile' %}', $('#form_about_me').serialize(), function (partial_render) {
                    $('#partial_profile_header').html(partial_render);
                    $('#edit_headline_div').hide();
                    $('#edit_about_me_div').hide();
                    console.log("reloaded");
                });
                return false;
            });
        });
    </script>
    <script src="{% static 'assets/components/common/forms/elements/bootstrap-datepicker/assets/lib/js/bootstrap-datepicker.js' %}?v=v1.9.6&sv=v0.0.1"></script>
    <script src="{% static 'assets/components/common/forms/elements/bootstrap-datepicker/assets/custom/js/bootstrap-datepicker.init.js' %}?v=v1.9.6&sv=v0.0.1"></script>
    <script src="{% static 'assets/components/common/forms/elements/jasny-fileupload/assets/js/bootstrap-fileupload.js' %}?v=v1.9.6&sv=v0.0.1"></script>
{% endblock %}